# {{node_name}}

{{description}}

## Quick Reference

| Item | Value |
|------|-------|
| Type | Python |
| Run | `bubbaloop node start {{node_name}}` |
| Logs | `bubbaloop node logs {{node_name}} -f` |

## File Structure

```
{{node_name}}/
├── AGENTS.md         # This file - AI agent context
├── node.yaml         # Daemon manifest (name, type, command)
├── config.yaml       # Runtime configuration
├── requirements.txt  # Python dependencies
└── main.py           # Main implementation (EDIT THIS)
```

## How to Modify

### Adding a New Zenoh Publisher
Edit `main.py`:
```python
# Topics follow scoped pattern: bubbaloop/{scope}/{machine_id}/{{node_name}}/{resource}
# The topic prefix is built automatically from BUBBALOOP_SCOPE and BUBBALOOP_MACHINE_ID
publish_topic = f"{self._topic_prefix}/my_topic"
publisher = session.declare_publisher(publish_topic)

# Publish data (in run loop)
publisher.put(json.dumps(data).encode())
```

### Adding a Subscriber
```python
def on_message(sample):
    data = json.loads(sample.payload.to_bytes())
    # Process data

# Subscribe using scoped pattern (wildcards discover across machines)
subscriber = session.declare_subscriber("bubbaloop/**/other_node/output", on_message)
```

### Changing Configuration
Edit `config.yaml`:
```yaml
publish_topic: "output"  # Appended to bubbaloop/{scope}/{machine_id}/{{node_name}}/
rate_hz: 10.0  # Adjust publish rate
```

## Zenoh Topics

All topics follow the scoped pattern: `bubbaloop/{scope}/{machine_id}/{{node_name}}/{resource}`

| Topic Suffix | Direction | Format | Description |
|--------------|-----------|--------|-------------|
| `output` | Publish | JSON | Main output data |
| `schema` | Queryable | Protobuf | FileDescriptorSet (if protos exist) |
| `manifest` | Queryable | JSON | Node self-description contract |
| `health` | Queryable | JSON | Node health status |
| `config` | Queryable | JSON | Read-only configuration |

Data published to these topics is:
- Visible in the Bubbaloop Dashboard
- Available to other nodes on the Zenoh network
- Persisted if a recorder node is running

## Dependencies

This node has no dependencies on other nodes.
